<avalonia:ReactiveUserControl xmlns="https://github.com/avaloniaui"
                                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                                xmlns:vm="using:SpecLens.Avalonia.ViewModels"
                                xmlns:models="using:JdeClient.Core.Models"
                                xmlns:AvaloniaEdit="clr-namespace:AvaloniaEdit;assembly=AvaloniaEdit"
                                xmlns:reactiveui="using:ReactiveUI.Avalonia"
                                xmlns:avalonia="http://reactiveui.net"
                                x:Class="SpecLens.Avalonia.Views.EventRulesTabView"
                                x:DataType="vm:EventRulesTabViewModel"
                                x:TypeArguments="vm:EventRulesTabViewModel">
    <Grid ColumnDefinitions="260,6,*">
        <Border Grid.Column="0"
                BorderBrush="{DynamicResource AppBorderBrush}"
                BorderThickness="0,0,1,0"
                Padding="8">
            <TreeView x:Name="EventRulesTree"
                      ItemsSource="{Binding Nodes}"
                      SelectedItem="{Binding SelectedNode}"
                      FontSize="10">
                <TreeView.Styles>
                    <Style Selector="TreeViewItem" x:CompileBindings="False">
                        <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" />
                    </Style>
                </TreeView.Styles>
                <TreeView.ItemTemplate>
                    <TreeDataTemplate DataType="models:JdeEventRulesNode"
                                      x:DataType="models:JdeEventRulesNode"
                                      ItemsSource="{Binding Children}">
                        <TextBlock Text="{Binding Name}" />
                    </TreeDataTemplate>
                </TreeView.ItemTemplate>
            </TreeView>
        </Border>

        <GridSplitter Grid.Column="1"
                      Background="{DynamicResource AppSplitterBrush}"
                      ResizeDirection="Columns"
                      ResizeBehavior="PreviousAndNext" />

        <Grid Grid.Column="2" RowDefinitions="Auto,*">
            <StackPanel Margin="12,10,12,6" Spacing="3">
                <TextBlock Text="{Binding DocumentTitle}"
                           FontSize="13"
                           FontWeight="SemiBold"
                           Foreground="{DynamicResource AppTextPrimaryBrush}" />
                <TextBlock Text="{Binding DataStructureName}"
                           FontSize="11"
                           Foreground="{DynamicResource AppTextSecondaryBrush}" />
                <TextBlock Text="{Binding StatusMessage}"
                           FontSize="11"
                           Foreground="{DynamicResource AppTextSecondaryBrush}" />
            </StackPanel>

            <Border Grid.Row="1"
                    Margin="12"
                    BorderBrush="{DynamicResource AppBorderStrongBrush}"
                    BorderThickness="1"
                    CornerRadius="4"
                    IsVisible="{Binding IsEventRulesView}">
                <AvaloniaEdit:TextEditor x:Name="EventRulesEditor"
                                         IsReadOnly="True"
                                         ShowLineNumbers="False"
                                         FontFamily="Consolas"
                                         FontSize="12"
                                         Background="{DynamicResource AppWindowBackgroundBrush}"
                                         HorizontalScrollBarVisibility="Auto"
                                         VerticalScrollBarVisibility="Auto" />
            </Border>

            <Grid x:Name="CodeEditorsGrid"
                  Grid.Row="1"
                  Margin="12"
                  IsVisible="{Binding IsCodeView}"
                  RowDefinitions="*,Auto,*">
                <Expander x:Name="HeaderCodeExpander"
                          Grid.Row="0"
                          IsExpanded="True"
                          Header="{Binding HeaderDocumentTitle}"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          HorizontalContentAlignment="Stretch"
                          VerticalContentAlignment="Stretch"
                          Expanded="OnCodeExpanderToggled"
                          Collapsed="OnCodeExpanderToggled">
                    <Border Margin="0,6,0,0"
                            BorderBrush="{DynamicResource AppBorderStrongBrush}"
                            BorderThickness="1"
                            CornerRadius="4"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch">
                        <AvaloniaEdit:TextEditor x:Name="HeaderCodeEditor"
                                                 IsReadOnly="True"
                                                 ShowLineNumbers="True"
                                                 FontFamily="Consolas"
                                                 FontSize="12"
                                                 MinHeight="150"
                                                 HorizontalAlignment="Stretch"
                                                 VerticalAlignment="Stretch"
                                                 Background="{DynamicResource AppWindowBackgroundBrush}"
                                                 HorizontalScrollBarVisibility="Auto"
                                                 VerticalScrollBarVisibility="Auto" />
                    </Border>
                </Expander>

                <GridSplitter x:Name="CodeEditorsSplitter"
                              Grid.Row="1"
                              Height="6"
                              Background="{DynamicResource AppSplitterBrush}"
                              ResizeDirection="Rows"
                              ResizeBehavior="PreviousAndNext"
                              HorizontalAlignment="Stretch"
                              VerticalAlignment="Stretch" />

                <Expander x:Name="SourceCodeExpander"
                          Grid.Row="2"
                          IsExpanded="True"
                          Header="{Binding SourceDocumentTitle}"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          HorizontalContentAlignment="Stretch"
                          VerticalContentAlignment="Stretch"
                          Expanded="OnCodeExpanderToggled"
                          Collapsed="OnCodeExpanderToggled">
                    <Border Margin="0,6,0,0"
                            BorderBrush="{DynamicResource AppBorderStrongBrush}"
                            BorderThickness="1"
                            CornerRadius="4"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch">
                        <AvaloniaEdit:TextEditor x:Name="SourceCodeEditor"
                                                 IsReadOnly="True"
                                                 ShowLineNumbers="True"
                                                 FontFamily="Consolas"
                                                 FontSize="12"
                                                 MinHeight="220"
                                                 HorizontalAlignment="Stretch"
                                                 VerticalAlignment="Stretch"
                                                 Background="{DynamicResource AppWindowBackgroundBrush}"
                                                 HorizontalScrollBarVisibility="Auto"
                                                 VerticalScrollBarVisibility="Auto" />
                    </Border>
                </Expander>
            </Grid>
        </Grid>
    </Grid>
</avalonia:ReactiveUserControl>
